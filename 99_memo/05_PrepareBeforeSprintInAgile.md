# 学習メモ：アジャイルでも事前に用意しておくとスムーズになるもの

作成日: 2024-04-01

## 背景

アジャイル開発では「必要になったタイミングで、必要な分だけ」が原則。
しかし、**全てを後回しにすると開発がスムーズに進まない**ものもある。

このドキュメントでは、Sprint 0（または開発開始前）に決めておくべきことを整理する。

---

## 事前準備の判断基準

以下に該当するものは事前に決めておくべき：

1. **後から変更すると影響が大きい**: 全コードに影響するルール
2. **チーム全員の認識を揃える必要がある**: 開発スタイル、命名規則
3. **最初のコードから適用したい**: フォーマッタ、Lint設定
4. **横断的関心事**: ログ、エラーハンドリング、認証
5. **運用に影響する**: 監視、バックアップ、インシデント対応

---

## カテゴリ別リスト

### 1. AS-IS理解（現行業務の把握）

| 項目 | 内容 | なぜ事前に必要か |
|-----|------|----------------|
| 業務フロー | 現行の業務プロセス（スイムレーン図） | ドメイン理解、見積もり精度向上 |
| 業務ルール | 現行のルール（概要レベル） | 何をシステム化するかの判断材料 |
| データフロー | データの発生・流れ・蓄積 | システム設計のインプット |
| 非機能ニーズ | 業務側の期待（性能、可用性等） | 非機能要件の根拠 |
| 課題分析 | 現行の問題点・改善機会 | バックログ優先順位の根拠 |

**注意**: 詳細化（デシジョンテーブル等）はEpic着手時で良い

---

### 2. アーキテクチャ・技術選定

| 項目 | 内容 | なぜ事前に必要か |
|-----|------|----------------|
| 技術スタック | 言語、フレームワーク、DB、インフラ | 全ての実装に影響 |
| システム構成 | 全体アーキテクチャ（概要レベル） | 設計判断の基盤 |
| ログ設計 | フォーマット、レベル、出力先 | 横断的関心事、後から変更が困難 |
| エラーハンドリング | エラーコード体系、レスポンス形式 | API設計の一貫性 |
| 認証・認可方針 | 認証方式、権限モデル | セキュリティの基盤 |

---

### 3. 開発プロセス・規約

| 項目 | 内容 | なぜ事前に必要か |
|-----|------|----------------|
| コーディング規約 | 命名規則、フォーマット | 最初のコードから統一したい |
| Lint/Formatter設定 | ESLint、Prettier等の設定 | 自動チェックで規約を強制 |
| Git運用 | ブランチ戦略、コミット規約、PRルール | 開発フローの統一 |
| API設計ガイドライン | URL命名、レスポンス形式 | 一貫したAPI設計 |
| ディレクトリ構成 | プロジェクト構造 | コードの置き場所の統一 |

---

### 4. 品質・テスト

| 項目 | 内容 | なぜ事前に必要か |
|-----|------|----------------|
| テスト戦略 | テストピラミッド/トロフィー | どこに注力するかの方針 |
| テストツール | 使用するツール | セットアップを最初に |
| カバレッジ目標 | 目標値 | 品質基準の共有 |
| 命名規則 | テストコードの書き方 | 統一したテストコード |

---

### 5. 運用・保守

| 項目 | 内容 | なぜ事前に必要か |
|-----|------|----------------|
| 運用体制 | 誰が何を担当するか | 役割分担の明確化 |
| 監視方針 | 何を監視するか、アラート基準 | 設計段階で考慮が必要 |
| インシデント対応 | レベル定義、エスカレーション | 緊急時の対応フロー |
| バックアップ方針 | RPO/RTO、バックアップ対象 | データ保護の基盤 |

---

## 優先度マトリクス

### 必須（開発開始前に決める）

| 項目 | 理由 |
|-----|------|
| 技術スタック | 開発環境構築に必要 |
| コーディング規約・Lint設定 | 最初のコードから適用 |
| Git運用 | 最初のコミットから適用 |
| ログ設計 | 横断的、後から変更困難 |
| テスト戦略・ツール | 最初のテストから適用 |

### 推奨（Sprint 0で決める）

| 項目 | 理由 |
|-----|------|
| AS-IS理解（業務フロー、ルール等） | ドメイン理解、見積もり精度 |
| システム構成（概要） | 設計判断の基盤 |
| エラーハンドリング方針 | API設計の一貫性 |
| 運用方針（監視、バックアップ） | 設計段階で考慮 |
| API設計ガイドライン | 一貫したAPI |

### あると良い（Epic着手前までに）

| 項目 | 理由 |
|-----|------|
| 認証・認可方針 | 該当Epic着手時までに |
| 環境構成（開発/本番） | 開発環境構築時に |
| CI/CD設定 | 最初のPRまでに |

---

## アンチパターン：事前に決めすぎてはいけないもの

| 項目 | なぜ事前に決めないか |
|-----|---------------------|
| 詳細なDB設計（テーブル定義） | 要件が変わる可能性、Epic着手時に |
| 詳細なAPI仕様 | 実装しながら決める |
| 画面設計（詳細） | ユーザーフィードバックを反映 |
| ビジネスルールのデシジョンテーブル | Epic着手時に詳細化 |
| 具体的な運用手順書 | 実装後でないと書けない |

---

## まとめ

### 事前に決めるべきもの

> **「後から変えると全体に影響するもの」「チーム全員の認識を揃えるもの」**

- 技術スタック
- コーディング規約・開発プロセス
- 横断的関心事（ログ、エラー、認証）
- テスト戦略
- 運用方針

### 後で決めるべきもの

> **「要件が変わる可能性があるもの」「実装しながら決めた方が良いもの」**

- 詳細な設計（DB、API、画面）
- 具体的な手順書
- ビジネスルールの詳細

### 判断に迷ったら

「これを決めずに開発を始めたら、どれくらい困るか？」を考える。

- すぐに困る → 事前に決める
- Epic着手時に困る → Sprint 0で決める
- 実装後でも対応できる → 後で決める

---

## 変更履歴

| 日付 | 変更内容 | 更新者 |
|------|---------|-------|
| 2024-04-01 | 初版作成 | - |
