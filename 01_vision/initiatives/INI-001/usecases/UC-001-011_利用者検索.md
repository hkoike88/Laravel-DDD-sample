# UC-001-011: 利用者検索

最終更新: 2024-04-22

---

## 基本情報

| 項目 | 値 |
|------|-----|
| ユースケースID | UC-001-011 |
| ユースケース名 | 利用者検索 |
| アクター | 図書館職員 |
| 関連Epic | - |
| 関連課題 | - |
| ステータス | Planned |

---

## 概要

図書館職員が利用者を検索し、一覧表示する。利用者番号、氏名、電話番号などの条件で検索し、貸出・返却処理や情報編集のために利用者を特定する。

---

## 事前条件

- 職員がシステムにログイン済みであること

---

## 事後条件

- 検索条件に合致する利用者一覧が表示される
- 選択した利用者の詳細情報にアクセス可能になる

---

## 基本フロー

1. 職員が利用者管理画面を開く
2. システムが利用者検索フォームと一覧を表示する
3. 職員が検索条件を入力する
   - 利用者番号
   - 氏名（部分一致）
   - ふりがな（部分一致）
   - 電話番号
4. 職員が「検索」ボタンをクリックする
5. システムが検索を実行する
6. システムが検索結果を一覧表示する
7. 職員が一覧から対象利用者を選択する
8. システムが利用者詳細画面を表示する

---

## 代替フロー

### 5a. 検索結果が0件の場合

1. システムが「該当する利用者が見つかりませんでした」と表示する
2. 職員が検索条件を変更する
3. 基本フロー4に戻る

### 5b. 検索結果が多すぎる場合（100件以上）

1. システムが「検索結果が多すぎます。条件を絞り込んでください」と表示する
2. 職員が検索条件を追加する
3. 基本フロー4に戻る

### 3a. 貸出カードをスキャンする場合

1. 職員が貸出カードのバーコードをスキャンする
2. システムが利用者番号を自動入力する
3. 基本フロー4に戻る

---

## ビジネスルール

| ルールID | ルール内容 |
|----------|-----------|
| BR-UC001-11-01 | 検索結果は最大100件まで表示 |
| BR-UC001-11-02 | 無効化された利用者も検索対象に含める（フィルタ可能） |
| BR-UC001-11-03 | 検索結果は氏名の五十音順でソート（デフォルト） |
| BR-UC001-11-04 | 部分一致検索は前方一致・後方一致・中間一致を選択可能 |

---

## 非機能要件

| 項目 | 要件 |
|------|------|
| パフォーマンス | 検索結果は2秒以内に表示する |
| 可用性 | 検索機能は常時利用可能 |
| セキュリティ | 検索結果の個人情報は必要最小限を表示 |

---

## 画面イメージ（概要）

### 検索フォーム

- 利用者番号（完全一致）
- 氏名（部分一致）
- ふりがな（部分一致）
- 電話番号（部分一致）
- ステータス（有効/無効/すべて）

### 検索結果一覧

- 利用者番号
- 氏名
- ふりがな
- 電話番号
- ステータス
- 有効期限
- 操作ボタン（詳細/編集）

### ボタン

- 検索ボタン
- クリアボタン
- 新規登録ボタン

---

## 入力項目

| 項目 | 必須 | 形式 | 備考 |
|------|:----:|------|------|
| 利用者番号 | - | 文字列 | 完全一致検索 |
| 氏名 | - | 文字列 | 部分一致検索 |
| ふりがな | - | ひらがな | 部分一致検索 |
| 電話番号 | - | 数字 | 部分一致検索 |
| ステータス | - | 選択 | 有効/無効/すべて（デフォルト：有効） |

---

## 関連ユースケース

| ユースケース | 関係 |
|-------------|------|
| UC-001-008_利用者アカウント登録 | 検索から新規登録へ遷移 |
| UC-001-009_利用者アカウント編集 | 検索結果から編集へ遷移 |
| UC-001-010_利用者アカウント無効化 | 検索結果から無効化へ遷移 |

---

## 技術実装メモ

- API エンドポイント: GET /api/patrons?query=xxx
- 検索インデックス: 氏名、ふりがな、電話番号にインデックス
- ページネーション: 1ページ20件
- キャッシュ: 検索結果は5分間キャッシュ

---

## 関連ドキュメント

- [利用者登録・管理業務フロー（AS-IS）](../../../../00_docs/10_business/asis/swimlane/user-registration-process.md)
- [バックエンド標準 - API設計](../../../../00_docs/20_tech/99_standard/backend/05_ApiDesign.md)
