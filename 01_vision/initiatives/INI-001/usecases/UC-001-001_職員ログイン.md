# UC-001-001: 職員ログイン

最終更新: 2025-12-26

---

## 基本情報

| 項目 | 値 |
|------|-----|
| ユースケースID | UC-001-001 |
| ユースケース名 | 職員ログイン |
| アクター | 図書館職員 |
| 関連Epic | EPIC-005（職員認証機能） |
| 関連課題 | - |
| ステータス | Planned |

---

## 概要

職員がシステムにログインし、職員向け機能（蔵書登録、貸出処理、返却処理、利用者管理など）を利用可能にする。

---

## 事前条件

- 職員アカウントがシステムに登録されていること
- 職員が有効なログイン情報（メールアドレス・パスワード）を持っていること
- 職員アカウントがロックされていないこと

---

## 事後条件

- 職員がシステムにログイン状態となる
- 職員向け機能（蔵書管理、貸出・返却、利用者管理など）が利用可能になる
- セッションが開始される

---

## 基本フロー

1. 職員がログイン画面を開く
2. 職員がメールアドレスを入力する
3. 職員がパスワードを入力する
4. 職員がログインボタンをクリックする
5. システムが認証情報を検証する
6. システムがセッションを開始する
7. システムが職員ダッシュボード画面にリダイレクトする

---

## 代替フロー

### 5a. 認証情報が不正な場合

1. システムが「メールアドレスまたはパスワードが正しくありません」とエラーを表示する
2. システムがログイン失敗回数を記録する
3. 職員が入力内容を修正する
4. 基本フロー4に戻る

### 5b. アカウントがロックされている場合

1. システムが「アカウントがロックされています。管理者にお問い合わせください」とエラーを表示する
2. ユースケース終了

### 5c. 5回連続でログイン失敗した場合

1. システムがアカウントをロックする
2. システムが「ログイン失敗回数が上限に達しました。アカウントがロックされました」と表示する
3. ユースケース終了

### 7a. セッションタイムアウトした場合

1. システムがセッション切れを検知する
2. システムがログイン画面にリダイレクトする
3. システムが「セッションがタイムアウトしました。再度ログインしてください」と表示する

---

## ビジネスルール

| ルールID | ルール内容 |
|----------|-----------|
| BR-UC001-01-01 | ログイン失敗は5回まで許容。5回連続失敗でアカウントロック |
| BR-UC001-01-02 | アイドルタイムアウトは30分 |
| BR-UC001-01-03 | 絶対タイムアウトは8時間 |
| BR-UC001-01-04 | パスワードは12文字以上、英大小文字・数字・記号必須 |
| BR-UC001-01-05 | 同時ログインは最大3台まで（管理者は1台） |

---

## 非機能要件

| 項目 | 要件 |
|------|------|
| パフォーマンス | ログイン処理は2秒以内に完了する |
| セキュリティ | パスワードは bcrypt (cost=12) でハッシュ化、通信は HTTPS 必須 |
| 可用性 | 図書館開館時間中は利用可能 |

---

## 画面イメージ（概要）

- メールアドレス入力フィールド
- パスワード入力フィールド（マスク表示）
- ログインボタン
- エラーメッセージ表示エリア

---

## 関連ユースケース

| ユースケース | 関係 |
|-------------|------|
| UC-001-002_職員ダッシュボード表示 | ログイン成功後の遷移先 |
| UC-000-006_職員ログアウト | ログアウト処理 |

---

## 技術実装メモ

- 認証方式: Laravel Sanctum（SPA認証）
- セッション管理: データベースセッション + HttpOnly Cookie
- CSRF保護: Laravel 標準の CSRF トークン
- パスワードハッシュ: bcrypt (cost=12)

---

## 関連ドキュメント

- [EPIC-005: 職員認証機能](../../../../02_backlog/00_epics/INI-000/EPIC-005/epic.md)
- [EPIC-007: セキュリティ対策準備](../../../../02_backlog/00_epics/INI-000/EPIC-007/epic.md)
- [セキュリティ標準](../../../../00_docs/20_tech/99_standard/security/00_Overview.md)
