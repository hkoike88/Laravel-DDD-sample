# UC-001-008: 利用者アカウント登録

最終更新: 2024-04-22

---

## 基本情報

| 項目 | 値 |
|------|-----|
| ユースケースID | UC-001-008 |
| ユースケース名 | 利用者アカウント登録 |
| アクター | 図書館職員 |
| 関連Epic | - |
| 関連課題 | - |
| ステータス | Planned |

---

## 概要

図書館職員が新規利用者の情報を登録し、貸出カードを発行する。本人確認を行い、利用者番号を採番してシステムに登録する。

---

## 事前条件

- 職員がシステムにログイン済みであること
- 利用者が登録申請書と本人確認書類を提出していること

---

## 事後条件

- 利用者アカウントが作成される
- 利用者番号が採番される
- 貸出カード情報が発行可能な状態になる
- 利用者が図書の貸出を利用可能になる

---

## 基本フロー

1. 職員が利用者管理画面を開く
2. 職員が「新規登録」ボタンをクリックする
3. システムが利用者情報入力フォームを表示する
4. 職員が利用者情報を入力する
   - 氏名（ふりがな）
   - 生年月日
   - 住所
   - 電話番号
   - 利用者区分（一般/学生/児童）
   - 備考（通勤・通学先など）
5. 職員が「登録」ボタンをクリックする
6. システムが入力内容を検証する
7. システムが利用者番号を自動採番する
8. システムが利用者アカウントを作成する
9. システムが有効期限（登録日から1年間）を設定する
10. システムが利用者詳細画面を表示する
11. システムが「利用者を登録しました」と表示する

---

## 代替フロー

### 6a. 必須項目が未入力の場合

1. システムが未入力項目にエラーを表示する
2. 職員が必須項目を入力する
3. 基本フロー5に戻る

### 6b. 住所が対象地域外の場合

1. システムが「対象地域外の住所です」と警告を表示する
2. 職員が通勤・通学先を備考欄に入力する
3. 職員が「市外利用者として登録」を選択する
4. 基本フロー5に戻る

### 10a. 貸出カードを即時印刷する場合

1. 職員が「カード印刷」ボタンをクリックする
2. システムが貸出カード印刷画面を表示する
3. 職員が印刷を実行する

---

## ビジネスルール

| ルールID | ルール内容 |
|----------|-----------|
| BR-UC001-08-01 | 登録対象は市内在住・在勤・在学者 |
| BR-UC001-08-02 | 有効期限は登録日から1年間 |
| BR-UC001-08-03 | 利用者番号は連番で自動採番する |
| BR-UC001-08-04 | 未成年者（小学生以下）は保護者情報を必須とする |
| BR-UC001-08-05 | 市外在住者は通勤・通学先の確認が必要 |

---

## 非機能要件

| 項目 | 要件 |
|------|------|
| パフォーマンス | 登録処理は3秒以内に完了する |
| セキュリティ | 個人情報は暗号化して保存 |
| 監査 | 登録操作をログに記録する |

---

## 画面イメージ（概要）

### 入力フォーム

- 氏名（必須）
- ふりがな（必須）
- 生年月日（必須）
- 住所（必須）
- 電話番号（必須）
- 利用者区分（必須）
- 備考（任意）

### ボタン

- 登録ボタン
- キャンセルボタン

---

## 入力項目

| 項目 | 必須 | 形式 | 備考 |
|------|:----:|------|------|
| 氏名 | ○ | 文字列（50文字以内） | 姓名をスペース区切り |
| ふりがな | ○ | ひらがな（50文字以内） | 姓名をスペース区切り |
| 生年月日 | ○ | 日付 | YYYY-MM-DD形式 |
| 住所 | ○ | 文字列（200文字以内） | 郵便番号含む |
| 電話番号 | ○ | 電話番号形式 | 連絡先として使用 |
| 利用者区分 | ○ | 選択 | 一般/学生/児童 |
| 備考 | - | 文字列（500文字以内） | 通勤・通学先など |

---

## 関連ユースケース

| ユースケース | 関係 |
|-------------|------|
| UC-001-009_利用者アカウント編集 | 登録後の編集 |
| UC-001-010_利用者アカウント無効化 | 登録後の無効化 |
| UC-001-011_利用者検索 | 登録済み利用者の検索 |

---

## 技術実装メモ

- API エンドポイント: POST /api/patrons
- 利用者番号生成: ULID形式
- 個人情報暗号化: AES-256-GCM
- 監査ログ: audit チャンネルに記録

---

## 関連ドキュメント

- [利用者登録・管理業務フロー（AS-IS）](../../../../00_docs/10_business/asis/swimlane/user-registration-process.md)
- [セキュリティ標準 - データ分類・保護ポリシー](../../../../00_docs/20_tech/99_standard/security/03_DataClassification.md)
