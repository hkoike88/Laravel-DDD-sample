# UC-000-001: Docker 環境構築

最終更新: 2025-12-23

---

## 概要

Docker Compose を使用して、開発環境に必要な全サービス（フロントエンド、バックエンド、データベース、リバースプロキシ）をコンテナ化し、一括で起動・停止できる環境を構築する。

---

## アクター

| アクター | 役割 |
|----------|------|
| 開発者 | 開発環境を起動・利用する |

---

## 事前条件

- Docker Desktop または Docker Engine がインストールされていること
- Docker Compose が利用可能であること
- Git でリポジトリをクローン済みであること

---

## 基本フロー

1. 開発者が `docker compose up -d` を実行する
2. システムが各コンテナイメージをビルドする
3. システムが各サービスを起動する
4. 開発者が各サービスにアクセスできることを確認する

---

## 代替フロー

### A1: コンテナビルド失敗時

1. システムがエラーメッセージを表示する
2. 開発者がエラー内容を確認し、設定を修正する
3. 開発者が再度 `docker compose up --build` を実行する

### A2: ポート競合時

1. システムがポート使用中エラーを表示する
2. 開発者が競合するプロセスを停止、または`.env`でポートを変更する
3. 開発者が再度 `docker compose up` を実行する

---

## 事後条件

- すべてのコンテナが正常に起動している
- 各サービスが指定ポートで待ち受けている

---

## 構築対象サービス

| サービス | イメージ/ビルド | ポート | 用途 |
|----------|----------------|--------|------|
| frontend | カスタムビルド | 5173 | React 開発サーバー |
| backend | カスタムビルド | 8000 | Laravel API サーバー |
| db | mysql:8.0 | 3306 | データベース |
| phpmyadmin | phpmyadmin:latest | 8080 | DB 管理ツール |
| nginx | nginx:alpine | 80 | リバースプロキシ |

---

## 成果物

| 成果物 | 配置場所 |
|--------|---------|
| docker-compose.yml | プロジェクトルート |
| .env.example | プロジェクトルート |
| Dockerfile (frontend) | frontend/ |
| Dockerfile (backend) | backend/ |
| nginx.conf | infrastructure/nginx/ |

---

## 関連 Use Case

| ID | Use Case 名 | 関係 |
|----|-------------|------|
| UC-000-002 | バックエンド初期設定 | 本 Use Case の後に実施 |
| UC-000-003 | フロントエンド初期設定 | 本 Use Case の後に実施 |
