# UC-001-004: 返却処理

最終更新: 2025-12-24

---

## 基本情報

| 項目 | 値 |
|------|-----|
| ユースケースID | UC-001-004 |
| ユースケース名 | 返却処理 |
| アクター | 図書館職員 |
| 関連Epic | EP-02（貸出・返却） |
| 関連課題 | ISS-004 |
| ステータス | Planned |

---

## 概要

職員が利用者から図書を返却受付する処理を行う。延滞状況を自動チェックし、予約がある場合は次の予約者に通知する。

---

## 事前条件

- 職員がログインしていること
- 返却対象の図書が「貸出中」状態であること

---

## 事後条件

- 図書の所蔵状態が「貸出可」または「予約取置中」に更新される
- 貸出記録が更新される（返却日が記録される）
- 利用者の現在貸出冊数が更新される
- 延滞していた場合、延滞フラグが更新される

---

## 基本フロー

1. 職員が返却図書のバーコード/ISBNを入力する
2. システムが貸出情報を表示する（貸出者、貸出日、返却期限）
3. システムが延滞状況をチェックする
4. システムが返却処理を実行する
5. システムが予約有無をチェックする
6. システムが完了メッセージを表示する

---

## 代替フロー

### 3a. 延滞している場合

1. システムが「延滞（○日超過）」と警告を表示する
2. 職員が利用者に延滞の注意を伝える
3. 基本フロー4に進む

### 5a. 予約がある場合

1. システムが「この図書に予約があります」と表示する
2. システムが図書の状態を「予約取置中」に更新する
3. システムが予約者への連絡リストに追加する
4. 職員が図書を取り置き棚に配置する

---

## ビジネスルール

| ルールID | ルール内容 |
|----------|-----------|
| BR-UC004-01 | 返却日時は自動で記録する |
| BR-UC004-02 | 延滞日数は返却期限と返却日から自動計算する |
| BR-UC004-03 | 予約がある場合は次の予約者に自動で連絡リストに追加する |

---

## 非機能要件

| 項目 | 要件 |
|------|------|
| パフォーマンス | 返却処理は30秒以内に完了する（現状3分→30秒に83%短縮） |
| 可用性 | 図書館開館時間中は利用可能 |
| 信頼性 | 返却記録は確実に保存される |

---

## 画面イメージ（概要）

- 図書バーコード入力フィールド
- 貸出情報表示エリア（貸出者名、貸出日、返却期限、延滞状況）
- 返却確認・実行ボタン
- 予約有無通知エリア
- 延滞警告表示

---

## 関連ドキュメント

- [課題分析 ISS-004](../../../../00_docs/10_business/asis/pain-points/issues-analysis.md#iss-004-延滞者の把握ができない)
- [AS-IS業務フロー 返却処理](../../../../00_docs/10_business/asis/swimlane/return-process.md)
