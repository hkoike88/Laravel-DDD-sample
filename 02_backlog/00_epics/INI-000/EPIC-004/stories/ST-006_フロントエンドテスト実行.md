# ST-006: フロントエンドテスト・リント実行確認

最終更新: 2025-12-23

---

## ストーリー

**開発者として**、フロントエンドのテスト、リント、型チェックが正常に実行できることを確認したい。
**なぜなら**、コード品質を維持するための仕組みが動作することを保証したいからだ。

---

## 関連情報

| 項目 | 値 |
|------|-----|
| Epic | [EPIC-004: 開発環境動作確認](../epic.md) |
| ポイント | 1 |
| 優先度 | Must |
| ステータス | Draft |

---

## 受け入れ条件

1. [ ] `npm run test` でテストが実行できること
2. [ ] `npm run lint` でリントエラーがないこと
3. [ ] `npm run typecheck` で型エラーがないこと
4. [ ] `npm run build` でビルドが成功すること
5. [ ] npm scripts が正常に動作すること

---

## 確認手順

### 1. コンテナに入る

```bash
docker compose exec frontend sh
```

### 2. テスト実行

```bash
# Vitest テスト実行
npm run test

# 期待される出力
#  ✓ src/App.test.tsx (1)
#    ✓ renders headline
#
#  Test Files  1 passed (1)
#  Tests       1 passed (1)
#  Duration    1.23s

# ウォッチモード
npm run test:watch

# カバレッジ付き
npm run test:coverage
```

### 3. リント実行

```bash
# ESLint 実行
npm run lint

# 期待される出力（エラーなしの場合）
# （出力なし、または "No ESLint warnings or errors"）

# 自動修正
npm run lint:fix
```

### 4. 型チェック

```bash
# TypeScript 型チェック
npm run typecheck

# 期待される出力（エラーなしの場合）
# （出力なし）

# tsc 直接実行
npx tsc --noEmit
```

### 5. ビルド確認

```bash
# プロダクションビルド
npm run build

# 期待される出力
# vite v6.0.x building for production...
# ✓ x modules transformed.
# dist/index.html                   0.xx kB │ gzip: 0.xx kB
# dist/assets/index-xxxxx.css       x.xx kB │ gzip: x.xx kB
# dist/assets/index-xxxxx.js        x.xx kB │ gzip: x.xx kB
# ✓ built in x.xxs

# ビルド結果のプレビュー
npm run preview
```

### 6. 全チェック実行

```bash
# 全品質チェック（package.json に定義されている場合）
npm run check
```

---

## 確認チェックリスト

| 確認項目 | コマンド | 確認 |
|----------|---------|------|
| テスト | `npm run test` | [ ] |
| リント | `npm run lint` | [ ] |
| 型チェック | `npm run typecheck` | [ ] |
| ビルド | `npm run build` | [ ] |
| プレビュー | `npm run preview` | [ ] |

---

## 期待される package.json scripts

```json
{
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "preview": "vite preview",
    "test": "vitest run",
    "test:watch": "vitest",
    "test:coverage": "vitest run --coverage",
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "typecheck": "tsc --noEmit",
    "check": "npm run typecheck && npm run lint && npm run test"
  }
}
```

---

## サンプルテストファイル

```tsx
// src/App.test.tsx
import { render, screen } from '@testing-library/react';
import { describe, it, expect } from 'vitest';
import App from './App';

describe('App', () => {
  it('renders headline', () => {
    render(<App />);
    expect(
      screen.getByText('図書館デジタル化システム')
    ).toBeInTheDocument();
  });
});
```

---

## トラブルシューティング

| 問題 | 原因 | 解決策 |
|------|------|--------|
| モジュール not found | 依存未インストール | `npm ci` |
| ESLint 設定エラー | 設定ファイル誤り | eslint.config.js を確認 |
| 型エラー | 型定義不足 | `@types/xxx` をインストール |
| ビルド失敗 | TypeScript エラー | `npm run typecheck` で詳細確認 |
| テストタイムアウト | 非同期処理 | waitFor/findBy を使用 |

### 依存パッケージ再インストール

```bash
# node_modules 削除して再インストール
rm -rf node_modules
npm ci
```

---

## タスク

### Spec Tasks（詳細設計）

- [ ] npm run test の実行確認
- [ ] npm run lint の実行確認
- [ ] npm run typecheck の実行確認
- [ ] npm run build の実行確認
- [ ] エラー発生時の対応

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2025-12-23 | 初版作成 |
