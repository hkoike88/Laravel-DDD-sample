# EPIC-004: 開発環境動作確認

最終更新: 2025-12-23

---

## 概要

構築した開発環境が正常に動作することを確認する。フロントエンド、バックエンド、データベースの連携を検証し、開発開始可能な状態であることを保証する。

---

## 関連情報

| 項目 | 値 |
|------|-----|
| イニシアチブ | [INI-000: 開発環境構築](../../../../01_vision/initiatives/INI-000/charter.md) |
| Use Case | [UC-000-004: 開発環境動作確認](../../../../01_vision/initiatives/INI-000/usecases/UC-000-004_開発環境動作確認.md) |
| 優先度 | Must |
| ステータス | Draft |

---

## ビジネス価値

開発環境が正常に動作することを検証し、開発チームが安心して開発を開始できる状態を保証する。
環境起因の問題を早期に発見・解決し、開発効率の低下を防ぐ。

---

## 受け入れ条件

1. 全サービスが `docker compose up -d` で起動すること
2. フロントエンド（http://localhost:5173）にアクセスできること
3. バックエンド API（http://localhost:8000/api）にアクセスできること
4. phpMyAdmin（http://localhost:8080）でDBに接続できること
5. フロントエンドからバックエンド API を呼び出せること
6. バックエンド・フロントエンドのテストが全て成功すること
7. 静的解析・リントがエラーなく通ること

---

## 確認対象サービス

| サービス | URL | 確認内容 |
|----------|-----|---------|
| フロントエンド | http://localhost:5173 | React アプリが表示される |
| バックエンド API | http://localhost:8000/api | JSON レスポンスが返る |
| phpMyAdmin | http://localhost:8080 | DB 管理画面が表示される |
| Nginx | http://localhost:80 | リバースプロキシ経由でアクセス可能 |

---

## User Story 一覧

| ID | Story 名 | ポイント | 優先度 | ステータス |
|----|----------|---------|--------|----------|
| [ST-001](./stories/ST-001_サービス起動確認.md) | 全サービスの起動確認 | 1 | Must | Draft |
| [ST-002](./stories/ST-002_バックエンドDB接続確認.md) | バックエンド→DB 接続確認 | 1 | Must | Draft |
| [ST-003](./stories/ST-003_フロントエンドバックエンド連携確認.md) | フロントエンド→バックエンド連携確認 | 2 | Must | Draft |
| [ST-004](./stories/ST-004_CORS設定確認.md) | CORS 設定確認 | 1 | Must | Draft |
| [ST-005](./stories/ST-005_バックエンドテスト実行.md) | バックエンドテスト実行確認 | 1 | Must | Draft |
| [ST-006](./stories/ST-006_フロントエンドテスト実行.md) | フロントエンドテスト・リント実行確認 | 1 | Must | Draft |

---

## 確認項目チェックリスト

### サービス起動確認

- [ ] `docker compose up -d` で全コンテナが起動
- [ ] `docker compose ps` で全サービスが Running 状態
- [ ] 各ポートでサービスにアクセス可能

### 連携確認

| 確認項目 | 方法 | 期待結果 |
|----------|------|---------|
| Backend → DB | マイグレーション実行 | テーブルが作成される |
| Frontend → Backend | API 呼び出し | データが取得できる |
| CORS 設定 | クロスオリジンリクエスト | エラーなく通信できる |

### テスト実行

| 対象 | コマンド | 期待結果 |
|------|---------|---------|
| バックエンド | `php artisan test` | 全テスト成功 |
| フロントエンド | `npm run test` | 全テスト成功 |
| 静的解析 | `./vendor/bin/phpstan analyse` | エラーなし |
| リント | `npm run lint` | エラーなし |
| 型チェック | `npm run typecheck` | エラーなし |

---

## 依存関係

### 前提条件

| Epic ID | Epic 名 | 関係 |
|---------|---------|------|
| EPIC-001 | Docker 環境構築 | 前提条件 |
| EPIC-002 | バックエンド初期設定 | 前提条件 |
| EPIC-003 | フロントエンド初期設定 | 前提条件 |

### 後続タスク

本 Epic が完了すると、開発環境構築イニシアチブ（INI-000）が完了となる。

---

## トラブルシューティング

| 問題 | 原因 | 解決策 |
|------|------|--------|
| コンテナが起動しない | ポート競合 | `lsof -i :PORT` で競合プロセスを特定し停止 |
| DB 接続エラー | 環境変数誤り | .env ファイルの DB_HOST, DB_PASSWORD を確認 |
| CORS エラー | 設定不足 | バックエンドの cors.php、Sanctum 設定を確認 |
| 依存パッケージエラー | キャッシュ問題 | `npm ci` / `composer install` を再実行 |
| HMR が動作しない | WebSocket 設定 | Nginx の WebSocket プロキシ設定を確認 |

---

## 成果物

| 成果物 | 配置場所 | 説明 |
|--------|---------|------|
| 動作確認チェックリスト | 本ドキュメント | 確認項目一覧 |
| 動作確認手順書 | README.md | 環境構築・確認手順 |

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2025-12-23 | 初版作成 |
