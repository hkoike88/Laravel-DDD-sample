# ST-001: 予約エンティティの設計

最終更新: 2025-12-24

---

## ストーリー

**開発者として**、予約を表現するエンティティを設計したい。
**なぜなら**、予約管理のドメインロジックを適切にカプセル化したいからだ。

---

## 関連情報

| 項目 | 値 |
|------|-----|
| Epic | [EPIC-005: 予約登録](../epic.md) |
| ポイント | 3 |
| 優先度 | Must |
| ステータス | Draft |

---

## 受け入れ条件

1. [ ] Reservation エンティティが作成されていること
2. [ ] ReservationId 値オブジェクトが作成されていること
3. [ ] 予約順番を保持できること
4. [ ] 予約状態（待機中・取り置き中・完了・キャンセル）を管理できること
5. [ ] 取り置き期限を管理できること

---

## タスク

### Design Tasks（外部設計）

- [ ] 予約エンティティのクラス図作成
- [ ] 予約状態遷移図の作成

### Spec Tasks（詳細設計）

- [ ] Reservation エンティティの実装
- [ ] ReservationId 値オブジェクトの実装
- [ ] ReservationStatus 列挙型の実装
- [ ] 予約順番管理ロジックの実装
- [ ] 単体テストの作成

---

## 技術詳細

### エンティティ構成

```
Domain/Reservation/
├── Reservation.php           # 予約エンティティ
├── ReservationId.php         # 予約ID（UUID）
├── ReservationStatus.php     # 予約状態（Enum）
├── ReservationRepository.php # リポジトリインターフェース
└── ReservationOrder.php      # 予約順番（値オブジェクト）
```

### 予約状態

| 状態 | 説明 |
|------|------|
| waiting | 待機中（図書が貸出中） |
| ready | 取り置き中（図書が返却された） |
| completed | 完了（貸出された） |
| cancelled | キャンセル |
| expired | 期限切れ |

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2025-12-24 | 初版作成 |
