# ST-004: 貸出上限チェックの実装

最終更新: 2025-12-24

---

## ストーリー

**図書館職員として**、貸出上限に達している利用者への貸出を防ぎたい。
**なぜなら**、ルールに基づいた適切な貸出管理を行いたいからだ。

---

## 関連情報

| 項目 | 値 |
|------|-----|
| Epic | [EPIC-003: 貸出処理](../epic.md) |
| ポイント | 2 |
| 優先度 | Must |
| ステータス | Draft |

---

## 受け入れ条件

1. [ ] 貸出上限（5冊）に達している場合、貸出がブロックされること
2. [ ] 警告メッセージが表示されること
3. [ ] 現在の貸出数が表示されること

---

## タスク

### Design Tasks（外部設計）

- [ ] ビジネスルールの確認（上限数、例外条件）

### Spec Tasks（詳細設計）

- [ ] LoanLimitChecker ドメインサービスの実装
- [ ] 貸出数カウントクエリの実装
- [ ] UseCase への統合
- [ ] 単体テストの作成

---

## ビジネスルール

| ルール | 内容 |
|--------|------|
| 貸出上限 | 5冊 |
| カウント対象 | status = 'borrowed' の貸出のみ |
| 延滞図書 | 上限カウントに含む |

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2025-12-24 | 初版作成 |
