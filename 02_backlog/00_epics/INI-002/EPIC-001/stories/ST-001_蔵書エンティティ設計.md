# ST-001: 蔵書エンティティ・Value Object の設計

最終更新: 2025-12-24

---

## ストーリー

**開発者として**、蔵書のドメインモデル（エンティティ・Value Object）を設計したい。
**なぜなら**、DDD に基づいた堅牢なドメイン層を構築し、ビジネスロジックを適切にカプセル化したいからだ。

---

## 関連情報

| 項目 | 値 |
|------|-----|
| Epic | [EPIC-001: 蔵書検索](../epic.md) |
| ポイント | 3 |
| 優先度 | Must |
| ステータス | Draft |

---

## 受け入れ条件

1. [ ] Book エンティティが作成されていること
2. [ ] BookId Value Object が作成されていること
3. [ ] ISBN Value Object が作成されていること（バリデーション含む）
4. [ ] BookStatus Value Object が作成されていること（available/borrowed/reserved）
5. [ ] 単体テストが作成されていること

---

## 技術仕様

### ディレクトリ構成

```
backend/packages/Domain/Book/
├── Book.php                 # エンティティ
├── BookId.php              # Value Object
├── ISBN.php                # Value Object
├── BookStatus.php          # Value Object (Enum)
└── BookRepositoryInterface.php  # リポジトリインターフェース
```

### Book エンティティ

```php
final class Book
{
    private function __construct(
        private BookId $id,
        private string $title,
        private ?string $author,
        private ?ISBN $isbn,
        private ?string $publisher,
        private ?int $publishedYear,
        private ?string $genre,
        private BookStatus $status,
    ) {}

    public static function create(...): self { }
    public function isAvailable(): bool { }
    public function borrow(): void { }
    public function return(): void { }
}
```

---

## 成果物

| 成果物 | 配置場所 |
|--------|---------|
| Book.php | backend/packages/Domain/Book/ |
| BookId.php | backend/packages/Domain/Book/ |
| ISBN.php | backend/packages/Domain/Book/ |
| BookStatus.php | backend/packages/Domain/Book/ |
| BookTest.php | backend/tests/Unit/Domain/Book/ |

---

## タスク

### Design Tasks（外部設計）

- [ ] エンティティの属性定義
- [ ] Value Object の洗い出し
- [ ] ビジネスルールの整理

### Spec Tasks（詳細設計）

- [ ] Book エンティティの実装
- [ ] Value Object の実装
- [ ] 単体テストの作成

---

## 変更履歴

| 日付 | 変更内容 |
|------|---------|
| 2025-12-24 | 初版作成 |
