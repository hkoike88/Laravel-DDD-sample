# 正常系テストケース: 蔵書検索画面

**Feature**: 004-book-search-ui
**Created**: 2025-12-24
**Type**: 正常系（Normal Cases）

---

## US1: キーワード検索と結果表示

### TC-N001: タイトルでの部分一致検索

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | タイトル欄に「猫」と入力 | 入力値が表示される |
| 2 | 検索ボタンをクリック | ローディング表示が出る |
| 3 | API応答後 | タイトルに「猫」を含む蔵書一覧が表示される |

**検証項目**:
- [ ] 検索結果件数が正しく表示される
- [ ] 結果テーブルにタイトル、著者、出版社、状態が表示される

---

### TC-N002: 著者名での部分一致検索

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 著者欄に「夏目」と入力 | 入力値が表示される |
| 2 | 検索ボタンをクリック | ローディング表示が出る |
| 3 | API応答後 | 著者名に「夏目」を含む蔵書一覧が表示される |

**検証項目**:
- [ ] 夏目漱石の著書が全て表示される
- [ ] 他の著者の書籍は表示されない

---

### TC-N003: タイトルと著者の複合検索

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | タイトル欄に「坊」、著者欄に「夏目」と入力 | 両方の入力値が表示される |
| 2 | 検索ボタンをクリック | ローディング表示が出る |
| 3 | API応答後 | 両条件を満たす蔵書のみ表示される |

**検証項目**:
- [ ] 「坊っちゃん」（夏目漱石）が表示される
- [ ] 他の夏目漱石の著書は表示されない

---

### TC-N004: ローディング表示

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 検索条件を入力 | 入力値が表示される |
| 2 | 検索ボタンをクリック | ボタンが「検索中...」に変わり無効化される |
| 3 | API応答後 | ボタンが「検索」に戻り有効化される |

**検証項目**:
- [ ] 検索中はボタンがdisabledになる
- [ ] ローディングスピナーが表示される

---

### TC-N005: 検索結果件数表示

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 著者欄に「夏目」と入力して検索 | 検索が実行される |
| 2 | 結果表示後 | 「検索結果: N件」が表示される |

**検証項目**:
- [ ] 件数がAPIレスポンスのtotalと一致する
- [ ] 件数が0の場合も正しく表示される

---

## US2: 蔵書状態の視覚的確認

### TC-N006: 貸出可能な蔵書の状態バッジ表示

**前提条件**: 検索結果に status: "available" の蔵書がある

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 検索を実行 | 検索結果が表示される |
| 2 | 状態カラムを確認 | 緑色の「貸出可」バッジが表示される |

**検証項目**:
- [ ] バッジの背景色が緑（bg-green-*）
- [ ] テキストが「貸出可」

---

### TC-N007: 貸出中の蔵書の状態バッジ表示

**前提条件**: 検索結果に status: "borrowed" の蔵書がある

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 検索を実行 | 検索結果が表示される |
| 2 | 状態カラムを確認 | 赤色の「貸出中」バッジが表示される |

**検証項目**:
- [ ] バッジの背景色が赤（bg-red-*）
- [ ] テキストが「貸出中」

---

### TC-N008: 予約ありの蔵書の状態バッジ表示

**前提条件**: 検索結果に status: "reserved" の蔵書がある

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 検索を実行 | 検索結果が表示される |
| 2 | 状態カラムを確認 | 黄色の「予約あり」バッジが表示される |

**検証項目**:
- [ ] バッジの背景色が黄（bg-yellow-*）
- [ ] テキストが「予約あり」

---

## US3: ISBN検索

### TC-N009: 有効なISBN-13での完全一致検索

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | ISBN欄に「9784003101018」と入力 | 入力値が表示される |
| 2 | 検索ボタンをクリック | 検索が実行される |
| 3 | 結果表示後 | 該当ISBNの蔵書のみ表示される |

**検証項目**:
- [ ] 検索結果が1件
- [ ] 表示された蔵書のISBNが入力値と完全一致

---

### TC-N010: 有効なISBN-10での完全一致検索

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | ISBN欄に「4003101014」と入力 | 入力値が表示される |
| 2 | 検索ボタンをクリック | 検索が実行される |
| 3 | 結果表示後 | 該当ISBNの蔵書のみ表示される |

**検証項目**:
- [ ] ISBN-10形式でも検索可能

---

## US4: ページネーション

### TC-N011: ページネーション表示

**前提条件**: 検索結果が21件以上ある

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 全件検索を実行 | 検索結果が表示される |
| 2 | ページネーションを確認 | ページ番号リンクが表示される |

**検証項目**:
- [ ] 1ページに20件が表示される
- [ ] ページ番号（1, 2, 3...）が表示される
- [ ] 「前へ」「次へ」リンクが表示される

---

### TC-N012: ページ番号クリックでのページ遷移

**前提条件**: 検索結果が複数ページある

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | ページ2をクリック | ローディング表示が出る |
| 2 | API応答後 | 21〜40件目の結果が表示される |

**検証項目**:
- [ ] 表示されるデータが2ページ目のもの
- [ ] 現在ページ番号がハイライトされる

---

### TC-N013: 「次へ」ボタンでのページ遷移

**前提条件**: 1ページ目を表示中、次のページがある

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 「次へ」をクリック | ローディング表示が出る |
| 2 | API応答後 | 2ページ目の結果が表示される |

**検証項目**:
- [ ] ページ番号が2に更新される
- [ ] 「前へ」が有効化される

---

### TC-N014: 「前へ」ボタンでのページ遷移

**前提条件**: 2ページ目以降を表示中

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 「前へ」をクリック | ローディング表示が出る |
| 2 | API応答後 | 前のページの結果が表示される |

**検証項目**:
- [ ] ページ番号が1減少する

---

## US5: 検索結果なし時のフィードバック

### TC-N015: 0件時のメッセージ表示

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 存在しないタイトル「ZZZZZ」で検索 | 検索が実行される |
| 2 | 結果表示後 | 「検索条件に一致する蔵書が見つかりませんでした」が表示される |

**検証項目**:
- [ ] エラーではなく情報メッセージとして表示
- [ ] アイコン（悲しい顔など）が表示される

---

### TC-N016: 0件時の検索ヒント表示

**前提条件**: 検索結果が0件

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 結果0件の状態を確認 | ヒントテキストが表示される |

**検証項目**:
- [ ] 「検索条件を変更して再度お試しください」等のヒントが表示される
- [ ] タイトルや著者名の一部入力を促すガイドがある

---

## 全件検索

### TC-N017: 条件なしでの全件検索

**前提条件**: 検索画面（/books）が表示されている

| Step | Action | Expected Result |
|------|--------|-----------------|
| 1 | 何も入力せずに検索ボタンをクリック | 検索が実行される |
| 2 | 結果表示後 | 全蔵書が表示される（ページネーション付き） |

**検証項目**:
- [ ] バリデーションエラーにならない
- [ ] 全件数が表示される
- [ ] ページネーションが正しく機能する

---

## Notes

- 全てのテストケースは手動テストまたは Vitest + React Testing Library で自動化可能
- APIモックには MSW (Mock Service Worker) の使用を推奨
- E2Eテストには Playwright または Cypress を推奨
